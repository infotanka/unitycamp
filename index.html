
<!DOCTYPE html>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">

<link rel="shortcut icon" href="/i/favicon.ico">
<link href="main.css" rel="stylesheet">

<meta name="keywords" content="South China Sea,China,Philippines,international relations">
<meta name="news_keywords" content="South China Sea,China,Philippines,international relations">
<meta itemprop="description" name="description" content="Who Will Win Control of the South China Sea?">
<link rel="image_src" href="http://graphics8.nytimes.com/newsgraphics/2013/10/27/south-china-sea/d4ddc253fb0e8783d3e57b3c5a189fcd2af63c5b/preview.png">

<meta name="viewport" content="initial-scale=1,width=device-width,height=device-height,user-scalable=no">


<title>UNITY RUN CAMP — беговой лагерь, где начинающие и опытные бегуны совершенствуют технику и наслаждаются активным отдыхом</title>

<script>
	var isMobile = function() {
	  return /iPad|iPod|iPhone|Android/.test(navigator.userAgent) || document.location.hash == "#ipad";
	}

	var isPhone = function() {
		return isMobile() && window.innerWidth < 768;
	}

  if (isMobile()) {
    document.documentElement.className = document.documentElement.className + " ios";
  }
</script>

<!--[if lte IE 8]><style type="text/css">
.video-container video,
.video-container img {
  position: static;
}
</style><![endif]-->

<script>
var pageHeight = /iPad|iPod|iPhone/.test(navigator.userAgent) ? function() {
  var screenWidth,
      screenHeight;
  switch (orientation) {
    case 90: case -90: screenWidth = screen.height, screenHeight = screen.availWidth; break;
    default: screenWidth = screen.width, screenHeight = screen.availHeight; break;
  }
  return screenHeight / screenWidth * document.body.clientWidth;
} : function() {
  return window.innerHeight || document.documentElement.clientHeight;
};

</script>
<script>(function() {

var defers = [];
defer = function(f) { defers.push(f); };
await = function() { defers.forEach(function(f) { f(); }); };

})();</script>

<div class="navigation">
  <div class="navigation-left">
      <img src="i/logo.png" height=60>

      <div style="font-family:Arial; margin-top:10px; margin-left:20px;">
      <a href="/camps/pag-201405.html">1-10 МАЯ 2014, о. Паг</a>
      <br>
      <a href="/camps/pag-201405.html">28 АВГ — 8 СЕН 2014, о. Паг</a>
    </div>

  </div>
  <div class="navigation-right">
  <div class="navigation-sections" style="margin-top:7px;">
      <a href="#1" class="navigation-section" title="Лагерь"><img src="i/1.png" width=25/></a>
      <a href="#2" class="navigation-section" title="Тренировки"><img src="i/2.png" width=45/></a>
      <a href="#3" class="navigation-section" title="Отдых"><img src="i/3.png" width=30/></a>
      <a href="#4" class="navigation-section" title="Впечатления участников"><img src="i/4.png" width=25/></a>
      <a href="#5" class="navigation-section" title="Записаться"><img src="i/1.png" width=25/></a>
    </div>

    <a href="mailto:train@unitycamp.com" style="font-family:Arial; margin-top:5px; margin-left:30px;">train@unitycamp.com</a>
    <br>
    <div class="fb-like" data-href="https://www.facebook.com/unityruncamp" data-layout="button_count" data-action="like" data-show-faces="true" data-share="false" style="margin-left:30px; margin-top:3px;"></div>
  </div>
</div>
<script>

document.querySelector(".navigation-share--twitter").href = "https://twitter.com/intent/tweet"
    + "?text=" + encodeURIComponent("A multimedia @NYTmag article on the struggles for power in the South China Sea.")
    + "&url=" + encodeURIComponent("http://www.nytimes.com/newsgraphics/2013/10/27/south-china-sea/");

defer(function() {

var anchor = d3.selectAll(".navigation-section").on("click", clicked),
    marker = d3.selectAll(".navigation-marker"),
    markerOffsets;

d3.select(".navigation-headline")
    .on("click", clicked);

d3.select(window)
    .on("resize.navigation", resized)
    .on("load.navigation", resized)
    .on("scroll.navigation", scrolled);

resized();

function resized() {
  markerOffsets = marker.datum(function(d, i) { return i ? this.offsetTop : 0; }).data();
  scrolled();
}

function scrolled() {
  var j = Math.max(0, Math.min(markerOffsets.length - 1, d3.bisectLeft(markerOffsets, pageYOffset + 80) - 1));
  anchor.classed("navigation-section--active", function(d, i) { return i === j; });
}

function clicked(d, i) {
  d3.event.preventDefault();
  d3.transition().duration(750).tween("scroll", function() {
    var offset = d3.interpolateNumber(pageYOffset, markerOffsets[i]);
    return function(t) { scrollTo(0, offset(t)); };
  });
}

});

</script>

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=237838789600836";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


<!-- Начало сайта -->
<div class="main">
  <div class="article">
    <div class="section video-sequence">
      <a class="navigation-marker" id="1"></a>
      <div class="video">
        <div class="video-container">
          <img src="i/20130905_110903.jpg">
        </div>
        <div class="video-caption video-caption--head">
          <div class="video-headline headline"><img src="i/logo.png"></div>
          <div class="video-summary">UNITY CAMP — это беговой лагерь, где начинающие и опытные бегуны совершенствуют технику и наслаждаются активным отдыхом</div>
          <div class="scroll-prompt">
            <svg width="18" height="8">
              <path d="M0,0L9,7L18,0"></path>
            </svg>
          </div>
        </div>
        <div class="video-caption video-caption--right">
          <a href="mailto:train@unitycamp.com" style="color:#fff;">train@unitycamp.com</a>
          <a href="http://facebook.com/unitycamp" style="color:#fff;">facebook.com/unitycamp</a>

          <div class="fb-like" data-href="https://www.facebook.com/unityruncamp" data-layout="button" data-action="like" data-show-faces="true" data-share="false" color-scheme="light" width=210 style="margin-top:15px;"></div>
          <br>
          <style>.ig-b- { display: inline-block; }
.ig-b- img { visibility: hidden; }
.ig-b-:hover { background-position: 0 -60px; } .ig-b-:active { background-position: 0 -120px; }
.ig-b-v-24 { width: 137px; height: 24px; background: url(//badges.instagram.com/static/images/ig-badge-view-sprite-24.png) no-repeat 0 0; }
@media only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (min--moz-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2 / 1), only screen and (min-device-pixel-ratio: 2), only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx) {
.ig-b-v-24 { background-image: url(//badges.instagram.com/static/images/ig-badge-view-sprite-24@2x.png); background-size: 160px 178px; } }</style>
<a href="http://instagram.com/unityruncamp?ref=badge" class="ig-b- ig-b-v-24" style="margin-top:15px;"><img src="//badges.instagram.com/static/images/ig-badge-view-24.png" alt="Instagram" /></a>

        </div>
      </div>
      <div class="video">
        <div class="video-container">
          <img src="i/20130506_1952_IMG_9711.jpg">
        </div>
        <div class="video-caption video-caption--right">Неважно, насколько быстро и далеко ты бегаешь. Если ты хочешь улучшить свою форму, встретить новых друзей — добро пожаловать на борт!</div>
      </div>
      <div class="video">
        <div class="video-container">
          <img src="i/20130508_2215_IMG_9820.jpg">
        </div>
        <div class="video-caption">Лагерь — это не просто тренировки, это общение с единомышленниками, совместные ужины и прогулки под звёздами.</div>
      </div>
    </div>

    <div class="section column" style="margin-top:30px;">
      <p>UNITY RUN CAMP … Тут будет текст про идею лагеря.</p>
    </div>

    <div class="section column">
      <a class="navigation-marker" id="2"></a>
      <h3>Тренировки</h3>
      <p>Тренировки очень разнообразны. Три группы, подробо программ с учётом индивидуальных особенностей, корректировка по прогрессу. Разбор техники по видео.</p>
      <table style="vertical-align:top;">
        <tr>
          <td width=450 style="margin:-20px; padding-left:20px; padding-right:20px; border:1px solid #ccc;">
            <p>Тренировки в лагере — это главное. По результатам анкет участников мы формируем группы, но на каждой тренировке я уделяю внимание бегунам, облегчаю или усложняю задачи индивидуально.</p>
            <p>Я закончил спортивный университет в Белграде, 10 лет был профессиональным бегуном и соревновался на велотреке. После этого тренировал спортсменов.</p>
            <p>Самое важное для тренера — чувствовать бегунов, их пределы, текущее состояние, настроение. В лагере я уделяю этому много внимания. Ну и конечно, если у спортсмена возникает вопрос, рад придти на помощь.</p>
            </td>
          <td style="vertical-align:top;">
            <img src="i/milan.png" width=180 style="margin-top:20px; margin-left:-4px;"/>
            <p style="margin-top:10px; margin-left:35px; font-size: 15px; line-height:25px;"><b>Милан Милетич, организатор лагеря</b> профессиональный спортсмен и тренер</p>
          </td>
        </tr>
      </table>
    </div>
    <div class="section video-sequence">
      <div class="video">
        <div class="video-container">
          <img src="i/20130504_1228_IMG_9091.jpg">
          <div class="video-source">Фото Максима Юшина</div>
        </div>
        <div class="video-caption video-caption--long">Интервалы</div>
      </div>
      <div class="video">
        <div class="video-container">
          <img src="i/20130905_112256.jpg">
        </div>
        <div class="video-caption video-caption--long">В гору</div>
      </div>
      <div class="video">
        <div class="video-container">
          <img src="i/1239593_458103364289072_358893998_n.jpg">
        </div>
        <div class="video-caption video-caption--long">Длинная</div>
      </div>
      <div class="video">
        <div class="video-container">
          <img src="i/20130902_181609.jpg">
        </div>
        <div class="video-caption video-caption--long">Восстановительная</div>
      </div>
      <div class="video">
        <div class="video-container">
          <img src="i/20130906_1145_IMG_8370.jpg">
        </div>
        <div class="video-caption video-caption--long">Плиометрические</div>
      </div>
      <div class="video">
        <div class="video-container">
          <img src="i/20130906_1147_IMG_8388.jpg">
        </div>
        <div class="video-caption video-caption--long">Растяжка</div>
      </div>
    </div>
    <div class="section column">
      <a class="navigation-marker" id="3"></a>
      <h3>Отдых</h3>
      <p>Спорт — спортом, но для гостей лагеря эти дни ещё как правило и долгожданный отпуск. Поэтому помимо изнурительных тренировок их ждёт насыщенная развлекательная программа.</p>

      <table style="vertical-align:top;">
        <tr>
          <td width=450 style="margin:-20px; padding-left:20px; padding-right:20px; border:1px solid #ccc;">
            <p>Тренировки в лагере — это главное. По результатам анкет участников мы формируем группы, но на каждой тренировке я уделяю внимание бегунам, облегчаю или усложняю задачи индивидуально.</p>
            <p>Я закончил спортивный университет в Белграде, 10 лет был профессиональным бегуном и соревновался на велотреке. После этого тренировал спортсменов.</p>
            <p>Самое важное для тренера — чувствовать бегунов, их пределы, текущее состояние, настроение. В лагере я уделяю этому много внимания. Ну и конечно, если у спортсмена возникает вопрос, рад придти на помощь.</p>
            </td>
          <td style="vertical-align:top;">
            <img src="i/kamilla.png" width=180 style="margin-top:20px; margin-left:-4px;"/>
            <p style="margin-top:10px; margin-left:35px; font-size: 15px; line-height:25px;"><b>Камилла Газиева, организатор лагеря</b> бегунья и муза, готовится к первому ультрамарафону</p>
          </td>
        </tr>
      </table>
    </div>
    <div class="section video-sequence">
      <div class="video">
        <div class="video-container">
          <img src="i/20130903_1922_IMG_7961.jpg">
        </div>
        <div class="video-caption video-caption--long">Пляж</div>
      </div>
      <div class="video">
        <div class="video-container">
          <img src="i/20130904_1842_IMG_8177.jpg">
        </div>
        <div class="video-caption video-caption--long">Яхта</div>
      </div>
      <div class="video">
        <div class="video-container">
          <img src="i/DSCF4716 copy.jpg">
        </div>
        <div class="video-caption video-caption--center">Ужины</div>
      </div>
    </div>
      
    <div class="section column" style="max-width: 900px;">
      <a class="navigation-marker" id="4"></a>
      <h3>Впечатления участников</h3>
      <h4>Осень 2013, Паг</h4>
      <a href="">Отчёт в блоге лагеря</a><br>
      <a href="">Отчёт и инфографика Тани Мисютиной</a>

      <h4>Весна 2013, Паг</h4>
      <a href="">Отчёт в блоге лагеря</a><br>

      <table style="vertical-align:top; margin-top:20px;">
        <tr>
          <td width=700 style="margin:-20px; padding-left:20px; padding-right:20px; border:1px solid #ccc;">
            <p>Решение поехать в спортивный лагерь пришло ко мне совершенно неожиданно. Я случайно увидела в Фейсбуке объявление о наборе группы и подумала: «Беговой лагерь – это же просто отличная идея!». Никакого бегового опыта у меня на тот момент не было, мне просто очень хотелось начать  бегать. За 3 недели до поездки Камилла выслала мне план, по которому следовало готовиться к лагерю. Раньше мне никогда не приходилось тренироваться по программе, и эта идея меня чрезвычайно увлекла. К моему удивлению, план оказался вполне реальным - нужно было бегать по 5-8 км 3 раза в неделю (эти тренировки идеально совпадали с пробежками с клубом Moskva River Runners), а также бегать  интервалы по понедельникам. Регулярные тренировки помогли мне справиться с волнением, которое я испытывала перед поездкой, а также немного поверить в себя и почувствовать начинающим бегуном ☺.</p>
            <p>Итак, когда я поехала в лагерь, у меня за плечами было чуть больше месяца регулярных тренировок и личный рекорд в виде очень медленных 8 км. Программа тренировок в лагере, признаюсь, меня сперва немного напугала, но отступать было некуда. Кроме того, я понимала, что в нашей группе кроме меня, есть еще несколько девушек начального уровня, а вместе всегда кто-то проще и веселее. Мы тренировались по два раза в день: утром и во второй половине дня. Программа тренировок была очень разнообразной: легкий бег, интервальные тренировки, беговые упражнения, упражнения на укрепление пресса, мышц спины и ног, плаванье, велосипед.</p>
            <p>Неожиданно для себя, я так втянулась в этот ритм, что каждая тренировка, каждая маленькая победа над собой доставляли необыкновенное удовольствие. Самой запоминающейся тренировкой была hill trainings (нужно было 4 раза вбежать на ооочень длинный холм). Тренировка была в предпоследний день – как раз перед длинным забегом, который должен был завершать программу лагеря. Честно признаться, когда я посмотрела на этот холм, услышала количество повторений – я просто не поверила, что смогу это сделать. Мне сразу отчетливо вспомнилось, как в один из первых дней я с огромным трудом одолела этот холм, а тут нужно было сделать это целых 4 раза. Я побежала, сделала одно повторение, второе, третье, четвертое, и вот я уже бегу обратно – по направлению к нашему дому, улыбаясь самой широкой улыбкой на которую только способна. Я не скажу, что это было просто, но это и не было настолько сложно, как казалось сначала. В какой-то момент я просто перестала бояться и так отчаянно себя жалеть. Ведь правду говорят – многие вещи кажутся невыполнимыми до тех пор, пока их не сделаешь. Надо ли говорить, что на следующее утро, перед финальной длинной пробежкой, я проснулась с абсолютно счастливой и уверенной в своих силах. В итоге я достаточно неплохо пробежала 16 км, что и по сей день является моим личным рекордом.</p>
            <p>Отдельно бы хотелось сказать про ту чудесную атмосферу, которая царила в лагере – мы все были одной большой спортивной семьей, поддерживали и радовались достижениям друг друга, а это очень важно, особенно когда ты выходишь за рамки своей зоны комфорта и начинаешь достигать новые, неведомые ранее цели. Милан – тренер лагеря, удивительный человек и профессионал, одно знакомство с которым уже очень ценно. От него мы узнали очень много про то, как нужно тренироваться, как начать бегать быстрее и больше, про питание, технику бега и спортивную экипировку. Для меня этот опыт оказался очень ценным, лагерь помог мне переоценить многие вещи в своей жизни, понять, что спорт может сделать мою жизнь совершенно другой – более яркой, осмысленной и счастливой. Надо ли говорить, что я бегаю до сих пор и готовлюсь к своему первому полумарафону, который планирую пробежать 20 октября в Амстердаме.</p>
            </td>
          <td style="vertical-align:top;">
            <img src="i/nadya_ryzhova.png" width=180 style="margin-top:20px; margin-left:-4px;"/>
            <p style="margin-top:0px; margin-left:40px; font-size: 15px; line-height:25px;"><b>Надя Рыжова,</b> <br>бегает с весны 2013</p>
          </td>
        </tr>
      </table>

      <table style="vertical-align:top; margin-top:20px;">
        <tr>
          <td width=700 style="margin:-20px; padding-left:20px; padding-right:20px; border:1px solid #ccc;">
            <p>Бегом я увлекалась в августе 2012 года. Бегала 1-2 раза в неделю и максимально пробегала 10 км за час. Зимой не бегала вообще, но когда увидела пост Камиллы о лагере в Хорватии, не сомневалась ни минуты: я поеду! Только потом появился страх и неуверенность: а вдруг я не смогу, буду плестись в конце и тянуть команду вниз. Ведь после такого большого перерыва и без подготовки соответствовать бегунам из клуба, казалось, будет непросто. Спокойствие пришло, когда Камилла выложила план тренировок, а еще больше уверенности появилось, когда я узнала, что будет 3 команды: новички (не буду писать слабые), средний уровень и сильные. Конечно, я попадала в команду новичков и была там не одна (а с каждым днем тренировок нас становилось все больше). Для нас был свой план тренировок, свой пэйс, расстояния и маршруты. Ребята из сильной команды нас всегда поддерживали, болели за нас и радовались нашим личным победам. Важно отметить, что все тренировки проходили под присмотром профессионального тренера и просто прекрасного человека, Милана) </p>
            <p>Подробно описывать жизнь в лагере не имеет смысла, так как туда нужно ехать и прожить эту маленькую жизнь самому. Во-первых, это шанс познакомиться с очень интересными и разносторонними людьми. Во-вторых, это просто круто узнать, что ты можешь тренироваться 7 дней подряд по 2 раза в день, а на 8-й день пробежать 18 км по жаре и холмам)) а еще, понять, что тебе мало 2-х тренировок в день и тебе хочется встать в 7 утра и пробежать 5 км просто так, под дождем и ветром (а кому и 30 км). Ну и конечно это незабываемый отдых, ведь помимо тренировок оставалось много времени для прогулок, купания, барбекью на пляже, совместных обедов и ужинов, а также лекций о правильном питании и тренировках. Так что если у вас есть сомнения ехать или не ехать- езжайте! Вы не пожалеете! P.S после лагеря мой личный результат за 10 км улучшился на 3 мин, а сейчас я поставила себе цель пробежать полумарафон в октябре 2013 и теперь я точно знаю, что смогу!</p>
            </td>
          <td style="vertical-align:top;">
            <img src="i/ksenia_mahortova.png" width=180 style="margin-top:20px; margin-left:-4px;"/>
            <p style="margin-top:0px; margin-left:40px; font-size: 15px; line-height:25px;"><b>Ксения Махортова,</b> <br>бегает с лета 2012</p>
          </td>
        </tr>
      </table>

    </div>

    <div class="section column">
      <a class="navigation-marker" id="5"></a>
      <h3>Записаться</h3>
      <p>
  </div>
</div>
<!-- Конец сайта -->


<!-- <div class="section footer-section">© 2013 Unity Camp</div> -->


<script>
function mobileReorient() {

  var height = window.innerHeight - 40;

  if (height > (720*.59) && window.innerWidth < 768) height = (720*.59);

  document.querySelectorAll(".video-sequence:first-child .video:first-of-type .video-container")[0]
      .style.height = height + "px";

  document.querySelectorAll(".video-sequence:first-child .video:first-of-type .video-caption--head")[0]
      .style.height = height + "px";
}

(function() {

  if (isMobile()) mobileReorient();

})();


defer(function() {

/* Only do if we're on iPad, iPhone or Android -- TG */
if (!isMobile()) return false;

var _mobile_assets = "http://i1.nyt.com/newsgraphics/2013/10/24/south-china-sea-videos/assets/";

d3.select(window)
  .on("resize", mobileReorient)
  .on("scroll", function() {
      d3.select(".navigation")
        .classed("navigation-solid", window.scrollY > 350)
  });

d3.select(".headline").html( d3.select(".headline").html().replace("<br>", " <br>") )

d3.select(".video-sequence:first-of-type").classed("ios-loaded", true);

d3.select(".column .byline").html( d3.select(".column .byline").html().replace("<br>", " <br>") )

d3.select(".section:nth-child(7)").classed("map-sequence", true);

setTimeout(function() {

  mobileImages.forEach(function(image) {

    if (isPhone() && image.phone) {
      for (var i in image.phone) {
        image[i] = image.phone[i];
      }
    }

    if (isPhone()) {
      if (image.file) image.file = image.file.replace("mobile-1024", "mobile-640");
    }

    if (!image.section) return false;

    image.url = _mobile_assets + image.file;

    var container;

    if (image.slide) {

      container = d3.select(".section:nth-child(" + image.section + ") .video:nth-of-type(" + image.slide + ") .video-container")

      if (image.type != "map" && image.type != "hide") {


        container.html("").append("img")
          .attr("src", image.url);

      }

      if (image.type != "hide") {

        var css;


        if (image.type == "map") css = "caption-" + image.file.replace("#","");
        else css = "caption-" + image.file.match(/\/([\w-]+)/)[1];

          d3.select(".section:nth-child(" + image.section + ") .video:nth-of-type(" + image.slide + ") .video-caption")
            .classed(css, true)

      }


      var slide = d3.select(".section:nth-child(" + image.section + ") .video:nth-of-type(" + image.slide + ")");

    }

    if (image.align) d3.select(".section:nth-child(" + image.section + ") .video:nth-of-type(" + image.slide + ") .video-caption")
      .classed(image.align.split(" ").map(function(dir) {
            return "align-" + dir
          }).join(" "), true)

    if (!image.hideRule && slide) slide.append("div")
        .attr("class", "video-rule")

    if (image.target == "map") {

      container = d3.select(".section:nth-child(" + image.section + ") .map")

      var source = d3.select(".map-source").html();

      if (isPhone()) container.html("<div class='map-source'>" + source + "</div>")

    }

    if (image.type == "hide") slide.classed("map-hide", true)

    if (image.type == "map") {

      container.html( container.html() + d3.select(image.file).text() )
    }

    if (image.mobileCaption) {
      d3.select(".section:nth-child(" + image.section + ") .video:nth-of-type(" + image.slide + ") .video-caption").html(image.mobileCaption);
    }

    if (image.type == "image") d3.select(".section:nth-child(" + image.section + ") .image:nth-child(" + image.slide + ") img")
        .attr("src", function(d) { return image.url; })

    if (image.type == "diptych") d3.select(".section:nth-child(" + image.section + ") .image:nth-child(" + image.slide + ") img:nth-child(" + image.image + ")")
        .attr("src", function(d) { return image.url; })

  })

}, 200)


});</script>
<script>defer(function() {

/* Just skip if we're on iPad, iPhone or Android -- TG */
if (isMobile()) return false;

var _video_assets = "http://graphics8.nytimes.com/newsgraphics/2013/10/24/south-china-sea-videos/assets/" + (innerWidth > 1150 ? 720 : 480) + "/",
    _image_assets = "http://i1.nyt.com/newsgraphics/2013/10/24/south-china-sea-videos/assets/" + (innerWidth > 1150 ? 720 : 480) + "/",
    _audio_assets = "http://graphics8.nytimes.com/newsgraphics/2013/10/24/south-china-sea-videos/assets/" + "audio/";

var mute = false,
    muteVolume = "volume",
    fixRatio = 16 / 9,
    fixHeight = innerWidth / fixRatio,
    fixTop = Math.round((innerHeight - fixHeight) / 2),
    fadeTop = Math.max(200, fixTop),
    fadeBottom = Math.min(innerHeight - 200, fixTop + fixHeight),
    fade = d3.interpolateRgb("#000", "#fff");

var headline = d3.select(".navigation-headline");

var sequence = d3.selectAll(".video-sequence")
    .datum(function() {
      return {
        first: !this.previousElementSibling,
        audio: this.getAttribute("data-audio"),
        length: this.querySelectorAll(".video").length
      };
    })
    .call(d3.behavior.watch()
      .on("scroll", sequencescrolled)
      .on("statechange", sequencestatechanged));

sequence.filter(function(d) { return d.audio; }).append("audio")
    .attr("src", function(d) { return _audio_assets + d.audio + ".mp3"; })
    .property("loop", true);

var section = d3.selectAll(".video")
    .datum(function() {
      var previous = this.previousElementSibling,
          next = this.nextElementSibling;
      return {
        video: this.getAttribute("data-video"),
        animation: this.hasAttribute("data-animation"),
        first: !previous || !d3.select(previous).classed("video"),
        last: !next || !d3.select(next).classed("video")
      };
    });

var sectionFixed = sequence.selectAll(".video")
    .each(function(d) { d.sequence = this.parentNode.__data__; })
    .call(d3.behavior.watch()
      .on("scroll", fixscrolled)
      .on("statechange", fixstatechanged));

var container = section.select(".video-container");

var video = container.filter(function(d) { return d.video; }).append("video")
    .attr("preload", "none")
    .attr("poster", function(d) { return d.animation && !d.first ? _image_assets + d.video + "-poster.jpg?2" : null; })
    .property("loop", function(d) { return !d.animation; })
    .text("Your browser does not support this video.");

video.append("source")
    .attr("src", function(d) { return _video_assets + d.video + ".mp4"; })
    .attr("type", "video/mp4");

video.append("source")
    .attr("src", function(d) { return _video_assets + d.video + ".webm"; })
    .attr("type", "video/webm");

if (!supportsViewportUnits()) sectionFixed.append("div")
    .style("height", fixHeight + "px");

var containerFixed = sectionFixed.select(".video-container")
    .style("z-index", function(d) { return d.first || d.last ? 1 : 2; })
    .style("position", function(d) { return d.first || d.last ? "absolute" : "fixed"; })
    .style("top", function(d) { return d.first || d.last ? null : fixTop + "px"; })
    .style("display", function(d) { return d.first || d.last ? null : "none"; });

containerFixed.append("div")
    .attr("class", "video-sequence-indicator")
    .style("margin-top", function(d) { return -d.sequence.length * 1.4 / 2 + "em"; })
    .text(function(d, i) { return d3.range(d.sequence.length).map(function(j) { return i === j ? "●" : "○"; }).join("\n"); });

var muteButton = d3.select(".navigation-volume")
    .on("click", muted);

d3.select(window)
    .on("load.video", loaded)
    .on("resize.video", resized);

d3.select("video")
    .attr("preload", "auto");

resized();

function loaded() {
  video.attr("preload", function(d) { return d.first ? "auto" : "none"; });
}

function muted() {
  mute = !mute;
  muteVolume = mute ? "_volume" : "volume";
  muteButton.classed("navigation-volume--muted", mute);
  d3.event.preventDefault();
  d3.selectAll("audio,video").interrupt().property("volume", mute
      ? function() { this._volume = this.volume; return 0; }
      : function() { return this._volume; });
}

function resized() {
  fixHeight = innerWidth / fixRatio;
  fixTop = Math.round((innerHeight - fixHeight) / 2);
  fadeTop = Math.max(200, fixTop);
  fadeBottom = Math.min(innerHeight - 200, fixTop + fixHeight);
  d3.select(".video-sequence:first-child").style("margin-top", fixTop + "px");
  containerFixed.style("height", fixHeight + "px").filter(function(d) {
    var rect = this.parentNode.getBoundingClientRect();
    return d.first ? rect.top < fixTop
        : d.last ? rect.bottom >= fixTop + fixHeight
        : true;
  }).style("top", fixTop + "px");
}

function fixscrolled(d) {
  if (d.first || d.last) {
    var fixed = (d.first && d3.event.rect.top < fixTop)
        || (d.last && d3.event.rect.bottom >= fixTop + fixHeight);
    d3.select(this.querySelector(".video-container"))
        .style("z-index", fixed ? 2 : 1)
        .style("position", fixed ? "fixed" : "absolute")
        .style("top", fixed ? fixTop + "px" : null);
  }

  var section = d3.select(this),
      container = section.select(".video-container"),
      videoNode = this.querySelector(".video-container video"),
      volume = 1;

  var opacityTop = d3.event.rect.top - fixHeight / 4,
      opacity = opacityTop > fixTop + fixHeight * 4 / 5 ? 0 // previous video fully opaque
        : !d.last && opacityTop < fixTop - fixHeight ? 0 // next video fully covers this video
        : opacityTop < fixTop ? 1 // this video is fully opaque, but may be covered by next video
        : Math.max(0, Math.min(1, 1 - (opacityTop - fixTop) / (fixHeight / 5))); // this video is partially opaque

  if (d.first) {
    if (videoNode) {
      volume = d3.event.rect.top < fixTop + fadeTop ? Math.max(0, Math.min(1, 1 - (d3.event.rect.top - fixTop) / fadeTop)) : 0;
      var play = d3.event.rect.top <= fixTop + fadeTop;
      if (videoNode.paused) {
        if (play && (!d.animation || (videoNode.currentTime < videoNode.duration && volume > .8))) {
          videoNode.play();
        }
      } else if (!play) {
        videoNode.pause();
      }
    }
    container.style("opacity", opacityTop >= fixTop - fixHeight ? 1 : 0);
  } else {
    container.style("opacity", opacity);
    if (videoNode) {
      if (videoNode.paused) {
        if (opacity) {
         if (!d.animation || (videoNode.currentTime < videoNode.duration && opacity > .8)) {
            videoNode.play();
          }
        } else if (videoNode.currentTime) {
          videoNode.currentTime = 0;
        }
      } else if (!opacity) {
        videoNode.pause();
        if (videoNode.currentTime) videoNode.currentTime = 0;
      }
    }
  }

  if (d.last) {
    if (videoNode) {
      volume = d3.event.rect.bottom < fadeBottom ? Math.max(0, Math.min(1, 1 - (fadeBottom - d3.event.rect.bottom) / fadeTop)) : 1;
      var play = d3.event.rect.bottom >= fadeBottom - fadeTop;
      if (videoNode.paused) {
        if (play && (!d.animation || (videoNode.currentTime < videoNode.duration && volume > .8))) {
          videoNode.play();
        }
      } else if (!play) {
        videoNode.pause();
      }
    }
  }

  section.select(".video-caption").style("opacity", opacityTop > fixTop ? (d.first ? 1 : Math.max(0, 1 - (opacityTop - fixTop) / (fixHeight / 5))) // fade in from bottom
      : opacityTop > fixTop - fixHeight * 4 / 5 ? 1 // this video is fully opaque and not covered
      : d.last ? 1 : Math.max(0, (opacityTop - fixTop + fixHeight * 4 / 5) / (fixHeight / 5) + 1)); // fade out to top

  if (videoNode) {
    videoNode[muteVolume] = volume = volume !== 1 ? volume // special-case volume for first and last fade
        : opacityTop < fixTop - fixHeight ? 0 // video is fully covered by next video
        : opacityTop < fixTop - fixHeight / 2 ? Math.max(0, Math.min(1, (opacityTop - fixTop + fixHeight) / (fixHeight / 2)))
        : opacity;

    if (d.first && d.sequence.first) headline.style("opacity", 1 - volume);
  }
}

function fixstatechanged(d) {
  d3.select(this.querySelector(".video-container"))
      .style("display", d3.event.state ? null : "none")
    .select("video")
      .each(function() {
        if (!d3.event.state) {
          if (!this.paused) this.pause();
          if (this.currentTime) this.currentTime = 0;
        }
      });

  if (d.first && d.sequence.first && !d3.event.state) headline.style("opacity", null);
}

function sequencescrolled() {
  var opacity = Math.max(0, Math.min(1, d3.event.rect.bottom < fadeBottom ? (fadeBottom - d3.event.rect.bottom) / fadeTop
      : d3.event.rect.top < fixTop + fadeTop ? (d3.event.rect.top - fixTop) / fadeTop
      : 1));
  d3.select("body").style("background", fade(opacity));
  d3.select(this).select("audio").property(muteVolume, 1 - opacity);
}

function sequencestatechanged() {
  var sequence = d3.select(this),
      audio = sequence.select("audio");
  if (d3.event.state) {
    sequence.selectAll("video").each(function() { this.preload = "auto"; });
    audio.each(function() { this.play(); });
  } else {
    d3.select("body").style("background", null);
    audio.each(function() { this.pause(); });
  }
}

function supportsViewportUnits() {
  var element = d3.select("body").append("div").style("width", "50vw"),
      expected = innerWidth / 2,
      actual = parseFloat(element.style("width"));
  element.remove();
  return Math.abs(expected - actual) <= 1;
}

});</script>

<!--[if gt IE 8]><!-->
<script src="http://graphics8.nytimes.com/newsgraphics/2013/10/27/south-china-sea/d4ddc253fb0e8783d3e57b3c5a189fcd2af63c5b/lib.js"></script>
<script>(function() {

var watched = [];

d3.behavior.watch = function() {
  var event = d3.dispatch("statechange", "scroll");

  function watch(selection) {
    selection.each(function(i) {
      watched.push({
        element: this,
        state: 0,
        index: i,
        event: event
      });
    });
  }

  return d3.rebind(watch, event, "on");
};

if (/iPhone|iPad|iPad|Android/.test(navigator.userAgent) || location.hash == "#ipad") {
  d3.select(window)
      .on("resize.watch", watch_scrolledStatic)
      .on("DOMContentLoaded.watch", watch_scrolledStatic);
} else {
  d3.select(window)
      .on("resize.watch", watch_scrolled)
      .on("scroll.watch", watch_scrolled)
      .on("DOMContentLoaded.watch", watch_scrolled);
}

function watch_scrolled() {
  watched.forEach(function(watch) {
    var rect = watch.element.getBoundingClientRect();
    if (rect.top + rect.height < 0 || rect.bottom - rect.height - innerHeight > 0) {
      watch_state(watch, 0);
    } else {
      var t = rect.top / (innerHeight - rect.height);
      watch_state(watch, t < 0 || t > 1 ? 1 : 2);
      watch_dispatch(watch, {type: "scroll", offset: t, rect: rect});
    }
  });
}

function watch_scrolledStatic() {
  watched.forEach(function(watch) {
    watch_state(watch, 1);
    watch_dispatch(watch, {type: "scroll", offset: .5, rect: {top: 0}}); // XXX rect
  });
}

function watch_state(watch, state1) {
  var state0 = watch.state;
  if (state0 !== state1) watch_dispatch(watch, {
    type: "statechange",
    state: watch.state = state1,
    previousState: state0
  });
}

function watch_dispatch(watch, event) {
  var element = watch.element,
      sourceEvent = event.sourceEvent = d3.event;
  try {
    d3.event = event;
    watch.event[event.type].call(element, element.__data__, watch.index);
  } finally {
    d3.event = sourceEvent;
  }
}

await();

})();</script>

<!--<![endif]-->
